// KRA 1 - Objective 1
const efficiency1_5 = document.getElementById('Efficiency1_5');
const efficiency1_3 = document.getElementById('Efficiency1_3');
const efficiency1_1 = document.getElementById('Efficiency1_1');

function get_efficiency_1_result(){
    console.log("GgGGGGG");
    if(efficiency1_5.checked){
        return 5;
    }else if(efficiency1_3.checked){
        return 3;
    }else if(efficiency1_1.checked){
        return 1;
    }else{
        return 0;
    }
}

// KRA 1 - Objective 2
const quality2_5 = document.getElementById('Quality2_5');
const quality2_4 = document.getElementById('Quality2_4');
const quality2_3 = document.getElementById('Quality2_3');
const quality2_2 = document.getElementById('Quality2_2');
const quality2_1 = document.getElementById('Quality2_1');

function get_quality_2_result(){
    if(quality2_5.checked){
        return 5;
    }else if(quality2_4.checked){
        return 4;
    }else if(quality2_3.checked){
        return 3;
    }else if(quality2_2.checked){
        return 2;
    }else if(quality2_1.checked){
        return 1;
    }else{
        return 0;
    }
}

const timeliness2_5 = document.getElementById('Timeliness2_5');
const timeliness2_4 = document.getElementById('Timeliness2_4');
const timeliness2_3 = document.getElementById('Timeliness2_3');
const timeliness2_2 = document.getElementById('Timeliness2_2');
const timeliness2_1 = document.getElementById('Timeliness2_1');

function get_timeliness_2_result(){
    if(timeliness2_5.checked){
        return 5;
    }else if(timeliness2_4.checked){
        return 4;
    }else if(timeliness2_3.checked){
        return 3;
    }else if(timeliness2_2.checked){
        return 2;
    }else if(timeliness2_1.checked){
        return 1;
    }else{
        return 0;
    }
}

// KRA 2 - Objective 3
const efficiency3_5 = document.getElementById('Efficiency3_5');
const efficiency3_3 = document.getElementById('Efficiency3_3');
const efficiency3_1 = document.getElementById('Efficiency3_1');

function get_efficiency_3_result(){
    if(efficiency3_5.checked){
        return 5;
    }else if(efficiency3_3.checked){
        return 3;
    }else if(efficiency3_1.checked){
        return 1;
    }else{
        return 0;
    }
}

// KRA 2 - Objective 4
const efficiency4_5 = document.getElementById('Efficiency4_5');
const efficiency4_3 = document.getElementById('Efficiency4_3');
const efficiency4_1 = document.getElementById('Efficiency4_1');

function get_efficiency_4_result(){
    if(efficiency4_5.checked){
        return 5;
    }else if(efficiency4_3.checked){
        return 3;
    }else if(efficiency4_1.checked){
        return 1;
    }else{
        return 0;
    }
}

// KRA 2 - Objective 5
const efficiency5_5 = document.getElementById('Efficiency5_5');
const efficiency5_3 = document.getElementById('Efficiency5_3');
const efficiency5_1 = document.getElementById('Efficiency5_1');

function get_efficiency_5_result(){
    if(efficiency5_5.checked){
        return 5;
    }else if(efficiency5_3.checked){
        return 3;
    }else if(efficiency5_1.checked){
        return 1;
    }else{
        return 0;
    }
}

// KRA 2 - Objective 6
const efficiency6_5 = document.getElementById('Efficiency6_5');
const efficiency6_3 = document.getElementById('Efficiency6_3');
const efficiency6_1 = document.getElementById('Efficiency6_1');

function get_efficiency_6_result(){
    if(efficiency6_5.checked){
        return 5;
    }else if(efficiency6_3.checked){
        return 3;
    }else if(efficiency6_1.checked){
        return 1;
    }else{
        return 0;
    }
}

// KRA 2 - Objective 7
const efficiency7_5 = document.getElementById('Efficiency7_5');
const efficiency7_3 = document.getElementById('Efficiency7_3');
const efficiency7_1 = document.getElementById('Efficiency7_1');

function get_efficiency_7_result(){
    if(efficiency7_5.checked){
        return 5;
    }else if(efficiency7_3.checked){
        return 3;
    }else if(efficiency7_1.checked){
        return 1;
    }else{
        return 0;
    }
}

// KRA 2 - Objective 8
const quality8_5 = document.getElementById('Quality8_5');
const quality8_4 = document.getElementById('Quality8_4');
const quality8_3 = document.getElementById('Quality8_3');
const quality8_2 = document.getElementById('Quality8_2');
const quality8_1 = document.getElementById('Quality8_1');

function get_quality_8_result(){
    if(quality8_5.checked){
        return 5;
    }else if(quality8_4.checked){
        return 4;
    }else if(quality8_3.checked){
        return 3;
    }else if(quality8_2.checked){
        return 2;
    }else if(quality8_1.checked){
        return 1;
    }else{
        return 0;
    }
}

// KRA 3 - Objective 9
const quality9_1 = document.getElementById('Quality9_1');
const quality9_2 = document.getElementById('Quality9_2');
const quality9_3 = document.getElementById('Quality9_3');
const quality9_4 = document.getElementById('Quality9_4');
const quality9_5 = document.getElementById('Quality9_5');

function get_quality_9_result(){
    if(quality9_5.checked){
        return 5;
    }else if(quality9_4.checked){
        return 4;
    }else if(quality9_3.checked){
        return 3;
    }else if(quality9_2.checked){
        return 2;
    }else if(quality9_1.checked){
        return 1;
    }else{
        return 0;
    }
}

const timeliness9_1 = document.getElementById('Timeliness9_1');
const timeliness9_2 = document.getElementById('Timeliness9_2');
const timeliness9_3 = document.getElementById('Timeliness9_3');
const timeliness9_4 = document.getElementById('Timeliness9_4');
const timeliness9_5 = document.getElementById('Timeliness9_5');

function timeliness_9_result(){
    if(timeliness9_5.checked){
        return 5;
    }else if(timeliness9_4.checked){
        return 4;
    }else if(timeliness9_3.checked){
        return 3;
    }else if(timeliness9_2.checked){
        return 2;
    }else if(timeliness9_1.checked){
        return 1;
    }else{
        return 0;
    }
}


// KRA 4 - Objective 10
const efficiency10_1 = document.getElementById('Efficiency10_1');
const efficiency10_3 = document.getElementById('Efficiency10_3');
const efficiency10_5 = document.getElementById('Efficiency10_5');

function get_efficiency_10_result(){
    if(efficiency10_5.checked){
        return 5;
    }else if(efficiency10_3.checked){
        return 3;
    }else if(efficiency10_1.checked){
        return 1;
    }else{
        return 0;
    }
}

// KRA 3 - Objective 11
const quality11_1 = document.getElementById('Quality11_1');
const quality11_2 = document.getElementById('Quality11_2');
const quality11_3 = document.getElementById('Quality11_3');
const quality11_4 = document.getElementById('Quality11_4');
const quality11_5 = document.getElementById('Quality11_5');


function get_quality_11_result(){
    if(quality11_5.checked){
        return 5;
    }else if(quality11_4.checked){
        return 4;
    }else if(quality11_3.checked){
        return 3;
    }else if(quality11_2.checked){
        return 2;
    }else if(quality11_1.checked){
        return 1;
    }else{
        return 0;
    }
}

const timeliness11_1 = document.getElementById('Timeliness11_1');
const timeliness11_2 = document.getElementById('Timeliness11_2');
const timeliness11_3 = document.getElementById('Timeliness11_3');
const timeliness11_4 = document.getElementById('Timeliness11_4');
const timeliness11_5 = document.getElementById('Timeliness11_5');

function get_timeliness_11_result(){
    if(timeliness11_5.checked){
        return 5;
    }else if(timeliness11_4.checked){
        return 4;
    }else if(timeliness11_3.checked){
        return 3;
    }else if(timeliness11_2.checked){
        return 2;
    }else if(timeliness11_1.checked){
        return 1;
    }else{
        return 0;
    }
}

// KRA 4 - Objective 12
const quality12_1 = document.getElementById('Quality12_1');
const quality12_2 = document.getElementById('Quality12_2');
const quality12_3 = document.getElementById('Quality12_3');
const quality12_4 = document.getElementById('Quality12_4');
const quality12_5 = document.getElementById('Quality12_5');

function get_quality_12_result(){
    if(quality12_5.checked){
        return 5;
    }else if(quality12_4.checked){
        return 4;
    }else if(quality12_3.checked){
        return 3;
    }else if(quality12_2.checked){
        return 2;
    }else if(quality12_1.checked){
        return 1;
    }else{
        return 0;
    }
}

const timeliness12_1 = document.getElementById('Timeliness12_1');
const timeliness12_2 = document.getElementById('Timeliness12_2');
const timeliness12_3 = document.getElementById('Timeliness12_3');
const timeliness12_4 = document.getElementById('Timeliness12_4');
const timeliness12_5 = document.getElementById('Timeliness12_5');

function get_timeliness_12_result(){
    if(timeliness12_5.checked){
        return 5;
    }else if(timeliness12_4.checked){
        return 4;
    }else if(timeliness12_3.checked){
        return 3;
    }else if(timeliness12_2.checked){
        return 2;
    }else if(timeliness12_1.checked){
        return 1;
    }else{
        return 0;
    }
}

// KRA 4 - Objective 13
const quality13_1 = document.getElementById('Quality13_1');
const quality13_2 = document.getElementById('Quality13_2');
const quality13_3 = document.getElementById('Quality13_3');
const quality13_4 = document.getElementById('Quality13_4');
const quality13_5 = document.getElementById('Quality13_5');

function get_quality_13_result(){
    if(quality13_5.checked){
        return 5;
    }else if(quality13_4.checked){
        return 4;
    }else if(quality13_3.checked){
        return 3;
    }else if(quality13_2.checked){
        return 2;
    }else if(quality13_1.checked){
        return 1;
    }else{
        return 0;
    }
}

const timeliness13_1 = document.getElementById('Timeliness13_1');
const timeliness13_2 = document.getElementById('Timeliness13_2');
const timeliness13_3 = document.getElementById('Timeliness13_3');
const timeliness13_4 = document.getElementById('Timeliness13_4');
const timeliness13_5 = document.getElementById('Timeliness13_5');


function get_timeliness_13_result(){
    if(timeliness13_5.checked){
        return 5;
    }else if(timeliness13_4.checked){
        return 4;
    }else if(timeliness13_3.checked){
        return 3;
    }else if(timeliness13_2.checked){
        return 2;
    }else if(timeliness13_1.checked){
        return 1;
    }else{
        return 0;
    }
}

// KRA 4 - Objective 14
const quality14_1 = document.getElementById('Quality14_1');
const quality14_2 = document.getElementById('Quality14_2');
const quality14_3 = document.getElementById('Quality14_3');
const quality14_4 = document.getElementById('Quality14_4');
const quality14_5 = document.getElementById('Quality14_5');

function get_quality_14_result(){
    if(quality14_5.checked){
        return 5;
    }else if(quality14_4.checked){
        return 4;
    }else if(quality14_3.checked){
        return 3;
    }else if(quality14_2.checked){
        return 2;
    }else if(quality14_1.checked){
        return 1;
    }else{
        return 0;
    }
}

const efficiency14_1 = document.getElementById('Efficiency14_1');
const efficiency14_2 = document.getElementById('Efficiency14_2');
const efficiency14_3 = document.getElementById('Efficiency14_3');
const efficiency14_4 = document.getElementById('Efficiency14_4');
const efficiency14_5 = document.getElementById('Efficiency14_5');

function get_efficiency_14_result(){
    if(efficiency14_5.checked){
        return 5;
    }else if(efficiency14_4.checked){
        return 4;
    }else if(efficiency14_3.checked){
        return 3;
    }else if(efficiency14_2.checked){
        return 2;
    }else if(efficiency14_1.checked){
        return 1;
    }else{
        return 0;
    }
}

// Plus Factor Form Elements
const quality15_5 = document.getElementById('Quality15_5');
const quality15_4 = document.getElementById('Quality15_4');
const quality15_3 = document.getElementById('Quality15_3');
const quality15_2 = document.getElementById('Quality15_2');
const quality15_1 = document.getElementById('Quality15_1');

function get_quality_15_result(){
    if(quality15_5.checked){
        return 5;
    }else if(quality15_4.checked){
        return 4;
    }else if(quality15_3.checked){
        return 3;
    }else if(quality15_2.checked){
        return 2;
    }else if(quality15_1.checked){
        return 1;
    }else{
        return 0;
    }
}


const efficiency15_5 = document.getElementById('Efficiency15_5');
const efficiency15_4 = document.getElementById('Efficiency15_4');
const efficiency15_3 = document.getElementById('Efficiency15_3');
const efficiency15_2 = document.getElementById('Efficiency15_2');
const efficiency15_1 = document.getElementById('Efficiency15_1');

function get_efficiency_15_result(){
    if(efficiency15_5.checked){
        return 5;
    }else if(efficiency15_4.checked){
        return 4;
    }else if(efficiency15_3.checked){
        return 3;
    }else if(efficiency15_2.checked){
        return 2;
    }else if(efficiency15_1.checked){
        return 1;
    }else{
        return 0;
    }
}

const timeliness15_5 = document.getElementById('Timeliness15_5');
const timeliness15_4 = document.getElementById('Timeliness15_4');
const timeliness15_3 = document.getElementById('Timeliness15_3');
const timeliness15_2 = document.getElementById('Timeliness15_2');
const timeliness15_1 = document.getElementById('Timeliness15_1');


function get_timeliness_15_result(){
    console.log("Happen");
    if(timeliness15_5.checked){
        return 5;
    }else if(timeliness15_4.checked){
        return 4;
    }else if(timeliness15_3.checked){
        return 3;
    }else if(timeliness15_2.checked){
        return 2;
    }else if(timeliness15_1.checked){
        return 1;
    }else{
        return 0;
    }
}

// Average Score Elements
const averageScoreLabel = document.getElementById('average-score');
const ratingDiv = document.getElementById('rating');

// Buttons
const backBtn = document.querySelector('.back-btn');
// const saveButton = document.getElementById('saveButton');


let kra1 = 0;
let kra2 = 0;
let kra3 = 0;
let kra4 = 0;
let plus_factor_main = 0;
let averageScore = 0;
let plusFactor = 0;
let totalScore = 0;
let ipcrf_content = undefined;



document.querySelectorAll('input[type="radio"]').forEach((input) => {
    input.addEventListener('change', calculateAverageScore);
});

function calculateAverageScore() {
    // Capture values from all KRAs
    const efficiency1 = getValue('efficiency1');
    const efficiency3 = getValue('efficiency3');
    const efficiency4 = getValue('efficiency4');
    const efficiency5 = getValue('efficiency5');
    const efficiency6 = getValue('efficiency6');
    const efficiency7 = getValue('efficiency7');
    const quality2 = getValue('quality2');
    const timeliness2 = getValue('timeliness2');
    const quality8 = getValue('quality8');
    const quality9 = getValue('quality9');
    const timeliness9 = getValue('timeliness9');
    const efficiency10 = getValue('efficiency10');
    const quality11 = getValue('quality11');
    const timeliness11 = getValue('timeliness11');
    const quality12 = getValue('quality12');
    const timeliness12 = getValue('timeliness12');
    const quality13 = getValue('quality13');
    const timeliness13 = getValue('timeliness13');
    const quality14 = getValue('quality14');
    const efficiency14 = getValue('efficiency14');
    const quality15 = getValue('quality15');
    const timeliness15 = getValue('timeliness15');
    const efficiency15 = getValue('efficiency15');


    kra1 =  ((efficiency1 + 1) / 2) * 0.07 +     
    ((quality2 + timeliness2) / 2) * 0.07 +  
    ((efficiency3 + 1) / 2) * 0.07 +     
    ((efficiency4 + 1) / 2) * 0.07 ;

    kra2 = ((efficiency5 + 1) / 2) * 0.07 +     // KRA 5
    ((efficiency6 + 1) / 2) * 0.07 +     // KRA 6
    ((efficiency7 + 1) / 2) * 0.07 +     // KRA 7
    ((quality8 + 1) / 2) * 0.07;

    kra3 = ((quality9 + timeliness9) / 2) * 0.07 +  // KRA 9
    ((efficiency10 + 1) / 2) * 0.07 +    // KRA 10
    ((quality11 + timeliness11) / 2) * 0.07;

    kra4 = ((quality12 + timeliness12) / 2) * 0.07 + // KRA 12
    ((quality13 + timeliness13) / 2) * 0.07 + // KRA 13
    ((efficiency14 + quality14) / 2) * 0.07;

    plus_factor_main = ((quality15 + timeliness15 + efficiency15) / 3) * 0.02;


    // Total score for main KRAs
    let totalKraScore = 
        //KRA 1
        ((efficiency1 + 5) / 2) * 0.07 +     
        ((quality2 + timeliness2) / 2) * 0.07 +  
        ((efficiency3 + 5) / 2) * 0.07 +     
        ((efficiency4 + 5) / 2) * 0.07 +     

        //KRA 2
        ((efficiency5 + 5) / 2) * 0.07 +     // KRA 5
        ((efficiency6 + 5) / 2) * 0.07 +     // KRA 6
        ((efficiency7 + 5) / 2) * 0.07 +     // KRA 7
        ((quality8 + 5) / 2) * 0.07 +        // KRA 8

        //KRA 3
        ((quality9 + timeliness9) / 2) * 0.07 +  // KRA 9
        ((efficiency10 + 5) / 2) * 0.07 +    // KRA 10
        ((quality11 + timeliness11) / 2) * 0.07 + // KRA 11

        //KRA 4
        ((quality12 + timeliness12) / 2) * 0.07 + // KRA 12
        ((quality13 + timeliness13) / 2) * 0.07 + // KRA 13
        ((efficiency14 + quality14) / 2) * 0.07;  // KRA 14



    // Total score for the Plus Factor KRA (KRA 15)
    let plusFactorScore = quality15 + timeliness15 + efficiency15;

    // Average Score calculation
    averageScore = totalKraScore;

    // Plus Factor calculation
    plusFactor = (plusFactorScore / 3) * 0.02;

    // Final Total Score
    totalScore = averageScore + plusFactor;

    // Display the result in the "average-score" label
    document.getElementById('average-score').innerText = totalScore.toFixed(3); // Show three decimal places

    // Determine the adjectival rating based on the average score
    let rating = getRating(totalScore);
    document.getElementById('rating').innerText = rating; // Display the rating
}

// Helper function to retrieve values
function getValue(name) {
    return document.querySelector(`input[name="${name}"]:checked`) ? 
           parseInt(document.querySelector(`input[name="${name}"]:checked`).value) : 0;
}

// Function to get adjectival rating based on average score
function getRating(averageScore) {
    if (averageScore >= 4.500) return "Outstanding";
    if (averageScore >= 3.500) return "Very Satisfactory";
    if (averageScore >= 2.500) return "Satisfactory";
    if (averageScore >= 1.500) return "Unsatisfactory";
    return "Poor"; // below 1.499
}


async function getIPCRF(){
    // const formData = new FormData();
    // formData.append('employee_id', employeeId); 
    // formData.append('password', password); 

    try {
        const response = await fetch('https://bnahs.pythonanywhere.com/api/teacher/school/get/ipcrf/part1/', {
            method: 'GET',
            headers: {
                'X-Requested-With': 'XMLHttpRequest',
            },
            credentials: 'include',
            // body: formData,
        });

        ipcrf_content = await response.json();
        if (response.ok) {
            console.log("Success Data : ", ipcrf_content);  
        } else {
            console.log("Error Data : ", ipcrf_content);
            // alert("Login Failed.")
        }
    } catch (error) {
        console.error("Error during fetch:", error);
    }
}


getIPCRF();
 


async function updateIPCRF1(){
    const formData = new FormData();
    // formData.append('employee_id', employeeId); 
    // formData.append('password', password); 

    let teacher_content = ipcrf_content['ipcrf']['content_for_teacher'];

    teacher_content['Content Knowledge and Pedagogy']['1']["EFFICIENCY"]["Rate"] = get_efficiency_1_result();
    teacher_content['Content Knowledge and Pedagogy']['2']["QUALITY"]["Rate"] = get_quality_2_result();
    teacher_content['Content Knowledge and Pedagogy']['2']["TIMELINESS"]["Rate"] = get_timeliness_2_result();
    teacher_content['Content Knowledge and Pedagogy']['3']["EFFICIENCY"]["Rate"] = get_efficiency_3_result();
    teacher_content['Content Knowledge and Pedagogy']['4']["EFFICIENCY"]["Rate"] = get_efficiency_4_result();
    teacher_content['Learning Environment & Diversity of Learners']['5']["EFFICIENCY"]["Rate"] = get_efficiency_5_result();
    teacher_content['Learning Environment & Diversity of Learners']['6']["EFFICIENCY"]["Rate"] = get_efficiency_6_result();
    teacher_content['Learning Environment & Diversity of Learners']['7']["EFFICIENCY"]["Rate"] = get_efficiency_7_result();
    teacher_content['Learning Environment & Diversity of Learners']['8']["QUALITY"]["Rate"] = get_quality_8_result();
    teacher_content['Curriculum and Planning & Assessment and Reporting']['9']["QUALITY"]["Rate"] = get_quality_9_result();
    teacher_content['Curriculum and Planning & Assessment and Reporting']['9']["TIMELINESS"]["Rate"] = timeliness_9_result();
    teacher_content['Curriculum and Planning & Assessment and Reporting']['10']["EFFICIENCY"]["Rate"] = get_efficiency_10_result();
    teacher_content['Curriculum and Planning & Assessment and Reporting']['11']["QUALITY"]["Rate"] = get_quality_11_result();
    teacher_content['Curriculum and Planning & Assessment and Reporting']['11']["TIMELINES"]["Rate"] = get_timeliness_11_result();
    teacher_content['Community Linkages and Professional Engagement & Personal Growth and Professional Development']['12']["QUALITY"]["Rate"] = get_quality_12_result();
    teacher_content['Community Linkages and Professional Engagement & Personal Growth and Professional Development']['12']["TIMELINES"]["Rate"] = get_timeliness_12_result();
    teacher_content['Community Linkages and Professional Engagement & Personal Growth and Professional Development']['13']["QUALITY"]["Rate"] = get_quality_12_result();
    teacher_content['Community Linkages and Professional Engagement & Personal Growth and Professional Development']['13']["TIMELINES"]["Rate"] = get_timeliness_13_result();
    teacher_content['Community Linkages and Professional Engagement & Personal Growth and Professional Development']['14']["QUALITY"]["Rate"] = get_efficiency_14_result();
    teacher_content['Community Linkages and Professional Engagement & Personal Growth and Professional Development']['14']["EFFICIENCY"]["Rate"] = get_efficiency_14_result();
    teacher_content['PLUS FACTOR']['15']["QUALITY"]["Rate"] = get_quality_15_result();
    teacher_content['PLUS FACTOR']['15']["EFFICIENCY"]["Rate"] = get_quality_15_result();
    teacher_content['PLUS FACTOR']['15']["TIMELINES"]["Rate"] = get_timeliness_15_result();


    formData.append('ipcrf_id', ipcrf_content['ipcrf']['connection_to_other']); // TODO: Get from IPCRF
    formData.append('average_score', averageScore); 
    formData.append('plus_factor', plusFactor); 
    formData.append('total_score', totalScore);
    formData.append('content', JSON.stringify(teacher_content));
    formData.append('plus_factor_main', plus_factor_main);
    formData.append('kra1', kra1);
    formData.append('kra2', kra2);
    formData.append('kra3', kra3);
    formData.append('kra4', kra4);

    try {
        const response = await fetch('https://bnahs.pythonanywhere.com/api/teacher/school/update/ipcrf/part1/', {
            method: 'POST',
            headers: {
                'X-Requested-With': 'XMLHttpRequest',
            },  
            credentials: 'include',
            body: formData,
        });

        const data = await response.json();
        if (response.ok) {
            console.log("Success Data : ", data);  
            // location.href = 'teacher_forms.html';
        } else {
            console.log("Error Data : ", data);
            // alert("Login Failed.")
        }
    } catch (error) {
        console.error("Error during fetch:", error);
    }
}







const logoutButton = document.getElementById('logoutLink');  // Logout button
const logoutModal = document.getElementById('logoutModal');
const yesButton = document.querySelector('.yes-btn');
const noButton = document.querySelector('.no-btn');

// Show modal when logout is clicked
logoutButton.addEventListener('click', function(event) {
    event.preventDefault();  // Prevent default logout behavior
    logoutModal.classList.remove('hidden');  // Show modal by removing 'hidden' class
});

// Hide modal when "No" is clicked
noButton.addEventListener('click', function() {
    logoutModal.classList.add('hidden');  // Hide modal by adding 'hidden' class
});

// Redirect when "Yes" is clicked
yesButton.addEventListener('click', async function() {
    try {
        
        const response = await fetch('https://bnahs.pythonanywhere.com/api/user/logout/', {
            method: 'POST',
            headers: {
                'X-Requested-With': 'XMLHttpRequest',
                
            },
            credentials: 'include',
        });

        const data = await response.json();
        if (response.ok) {
            console.log("Success Data : ", data); 
            window.location.href = '../../get-started.html'; 
        } else {
            console.log("Error Data : ", data);
        }
    } catch (error) {
        console.error("Error during fetch:", error);
    }
});


const requiredFields = [
"efficiency1", "quality2", "timeliness2",
"efficiency3", "efficiency4", "efficiency5",
"efficiency6", "quality8", "efficiency7",
"quality9", "timeliness9", "efficiency10",
"quality11", "timeliness11", "quality12",
"timeliness12", "quality13", "timeliness13",
"quality14", "efficiency14", "quality15",
"efficiency15", "timeliness15"
];


const saveButton = document.querySelector("#saveButton");

// Function to validate the form
function validateForm() {
    let isValid = true;

    requiredFields.forEach((name) => {
        const selectedOption = document.querySelector(`input[name="${name}"]:checked`);
        const ratingWrapper = document.querySelector(`input[name="${name}"]`).closest('.ratings, .rating-options').querySelector('.rating-wrapper');

        if (!selectedOption) {
            isValid = false;

            // Add error class to show red border and background
            if (ratingWrapper) {
                ratingWrapper.classList.add("error");
            }
        } else {
            // Remove error class if answered
            if (ratingWrapper) {
                ratingWrapper.classList.remove("error");
            }
        }
    });

    if (!isValid) {
        alert("Please answer all sections before saving.");
    }

    return isValid;
}

// Function to update IPCRF data
// Add click event listener to the "Save" button
saveButton.addEventListener("click", function () {
    const isFormValid = validateForm();


    //updateIPCRF1(); // FOR TESTING ONLY
    // If the form is valid, proceed to the next page
    if (isFormValid) {
        updateIPCRF1(); // Uncomment when official
        
}
});















