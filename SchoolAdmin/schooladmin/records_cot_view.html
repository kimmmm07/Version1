<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>School Admin View COT Proficient</title>
    <!-- FontAwesome for icons -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="records_cot_view_css.css">
</head>
<body>
    <nav class="navbar">
        <div class="navbar-logo">
            <img src="assets\image 6.png" alt="DepED Logo" />
        </div>
        <ul class="navbar-menu">
            <li><a href="schooladmin_home.html" class="nav-link"><img src="assets/House_01.png" alt="Home Icon" class="nav-icon"> Home</a></li>
            <li><a href="faculty.html" class="nav-link"><img src="assets/Users_Group1.png" alt="Faculty Icon" class="nav-icon"> Faculty</a></li>
            <li><a href="sadmin_form.html" class="nav-link form"><img src="assets/File_Document1.png" alt="Faculty Icon" class="nav-icon"> Form</a></li>
            <li><a href="results.html" class="nav-link"><img src="assets/Check Document.png" alt="Results Icon" class="nav-icon"> Results</a></li>
            <li><a href="records.html" class="nav-link records active"><img src="assets/Folders.png" alt="Records Icon" class="nav-icon"> Records</a></li>
            <li id="logoutLink" class="logout-btn">
                <a href="../../index.html">
                    <img src="assets/Log_Out.png" alt="Logout Icon" class="nav-icon"> Logout
                </a>
            </li>
        </ul>
    </nav>

    <div class="container" id="rpmsContainer2">
        <!-- Action buttons positioned in the upper-right corner of the container -->
        <div class="action-buttons">
            <button id="downloadPdf" class="action"><i class="fas fa-file-pdf"></i> Download PDF</button>
            <button id="printForm" class="action"><i class="fas fa-print"></i> Print Form</button>
        </div> 
    
        <br>
        <img src="assets/deped.png" alt="DepEd Logo" class="logo" id="depedLogo2">
        <h1 id="formTitle2">COT – RPMS</h1>
        <h2 id="teacherLevel2">Teacher I – III</h2>
        <h3 id="ratingSheetTitle2">Rating Sheet</h3>
    
        <section class="info-section" id="infoSection2">
            <div class="info-block">
                <label>OBSERVER:</label>
                <div class="input-field" id="observerName2">Bernadette Coleman</div>
            </div>
            <div class="info-block">
                <label>DATE:</label>
                <div class="input-field" id="observationDate2">September 05, 2024</div>
            </div>
            <div class="info-block">
                <label>TEACHER OBSERVED:</label>
                <div class="input-field" id="teacherObserved2">John Doe</div>
            </div>
            <div class="info-block">
                <label>QUARTER:</label>
                <div class="input-field" id="observationQuarter2">Quarter 1</div>
            </div>
            <div class="info-block">
                <label>SUBJECT & GRADE LEVEL TAUGHT:</label>
                <div class="input-field" id="subjectGradeLevel2">Science, Junior High School</div>
            </div>
            <div class="info-block">
                <label>SCHOOL YEAR:</label>
                <div class="input-field" id="schoolYear2">2023-2024</div>
            </div>
            <!-- <div class="observation-section" id="observationSection2">
                <label><b>Observation:</b></label>
                <label><input type="checkbox" checked id="observation1"> 1</label>
                <label><input type="checkbox" id="observation2"> 2</label>
                <label><input type="checkbox" id="observation3"> 3</label>
                <label><input type="checkbox" id="observation4"> 4</label>
            </div> -->
        </section>
    
        <section class="directions" id="directionsSection2">
            <h4>DIRECTION FOR THE OBSERVERS:</h4>
            <ol>
                <li>Rate each item on the checklist according to how well the teacher performed during the classroom observation. Mark the appropriate column with a (✔) symbol.</li>
                <li>Each indicator is assessed on an individual basis, regardless of its relationship to other indicators.</li>
                <li>For schools with only one observer, this form will serve as the final rating sheet.</li>
            </ol>
        </section>
    
        <section class="rating-section" id="ratingSection2">
            <table id="ratingTable2">
                <thead>
                    <tr>
                        <th>INDICATORS</th>
                        <th>3</th>
                        <th>4</th>
                        <th>5</th>
                        <th>6</th>
                        <th>7</th>
                        <th>NO*</th>
                    </tr>
                </thead>
                <tbody>
                    <tr id="indicator1Row">
                        <td>1. Applied knowledge of content within and across curriculum teaching areas.</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr id="indicator2Row">
                        <td>2. Used a range of teaching strategies that enhance learner achievement in literacy and numeracy skills.</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr id="indicator3Row">
                        <td>3. Applied a range of teaching strategies to develop critical and creative thinking, as well as other higher-order thinking skills.</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr id="indicator4Row">
                        <td>4. Displayed proficient use of Mother Tongue, Filipino, and English to facilitate teaching and learning.</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr id="indicator5Row">
                        <td>5. Established a safe and secure learning environment to enhance learning through the consistent implementation of policies, guidelines, and procedures.</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr id="indicator6Row">
                        <td>6. Maintained a learning environment that promotes fairness, respect, and care to encourage learning.</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr id="indicator7Row">
                        <td>7. Maintained consistent learning environments that support learner participation.</td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                </tbody>
            </table>
        </section>
    
        <section class="comments-section" id="commentsSection2">
            <label for="comments2"><b>Comments/Recommendations:</b></label>
            <textarea id="comments2" name="comments2"></textarea>
            <p><b>*NO </b>stands for <b>Not Observed</b> which automatically gets a rating of 3.</p>
        </section><br>
    
        <section class="signatures">
            <div class="signature-block">
                <input class="teacherSignature" id="teacherSignature2" disabled><br>
                <label>Signature over Printed Name of the Teacher</label>
            </div>
            <div class="signature-block" >
                <input class="observerSignature" id="observerSignature2" disabled><br>
                <label>Signature over Printed Name of the Observer</label>
            </div>
        </section>
    
        <div class="buttons" id="buttonsSection2">
            <a href="records.html"><button class="back" id="backButton2">Back</button></a>
        </div>
    </div>

    <!-- Logout Confirmation Modal -->
    <div id="logoutModal" class="modal hidden"> <!-- Added 'hidden' class to hide by default -->
        <div class="modal-content">
            <p>Are you sure you want to logout?</p>
            <div class="modal-buttons">
                <button class="yes-btn">Yes</button>
                <button class="no-btn">No</button>
            </div>
        </div>
    </div>

    <script>


// Main Container
const rpmsContainer2 = document.getElementById("rpmsContainer2");

// Action Buttons
const downloadPdfButton2 = document.getElementById("downloadPdf");
const printFormButton2 = document.getElementById("printForm");

// Title and Section Headers
const formTitle2 = document.getElementById("formTitle2");
const teacherLevel2 = document.getElementById("teacherLevel2");
const ratingSheetTitle2 = document.getElementById("ratingSheetTitle2");

// Info Section Elements
const observerName2 = document.getElementById("observerName2");
const observationDate2 = document.getElementById("observationDate2");
const teacherObserved2 = document.getElementById("teacherObserved2");
const observationQuarter2 = document.getElementById("observationQuarter2");
const subjectGradeLevel2 = document.getElementById("subjectGradeLevel2");
const schoolYear2 = document.getElementById("schoolYear2");

// Observation Section Checkboxes
const observation1 = document.getElementById("observation1");
const observation2 = document.getElementById("observation2");
const observation3 = document.getElementById("observation3");
const observation4 = document.getElementById("observation4");

// Rating Table
const ratingTable2 = document.getElementById("ratingTable2");

// Example: Accessing specific ratings
// const indicator1Rating3 = document.getElementById("indicator1Rating3");
// const indicator2Rating7 = document.getElementById("indicator2Rating7");
// const indicator3Rating7 = document.getElementById("indicator3Rating7");
// const indicator4Rating7 = document.getElementById("indicator4Rating7");
// const indicator5Rating7 = document.getElementById("indicator5Rating7");
// const indicator6Rating7 = document.getElementById("indicator6Rating7");
// const indicator7Rating5 = document.getElementById("indicator7Rating5");

// Comments Section
const additionalComments = document.getElementById("comments2");

// Signatures Section
const teacherSignature2 = document.getElementById("teacherSignature2");
const observerSignature2 = document.getElementById("observerSignature2");

// Back Button
const backButton2 = document.getElementById("backButton2");


// Function to download the form as a PDF
document.getElementById('downloadPdf').addEventListener('click', function () {
    const formContent = document.querySelector('.container');

    // Use html2canvas to convert the HTML to canvas
    html2canvas(formContent).then(function (canvas) {
        const imgData = canvas.toDataURL('image/png');
        const pdf = new jsPDF();
        
        // Add image to PDF
        pdf.addImage(imgData, 'PNG', 10, 10, 190, 0); // Adjust dimensions as needed
        
        // Save the generated PDF
        pdf.save('Teacher_Rating_Sheet.pdf');
    });
});


// Function to print the form
document.getElementById('printForm').addEventListener('click', function () {
    window.print();
});


const indicator1Row = document.getElementById('indicator1Row');
const indicator2Row = document.getElementById('indicator2Row'); 
const indicator3Row = document.getElementById('indicator3Row');
const indicator4Row = document.getElementById('indicator4Row');
const indicator5Row = document.getElementById('indicator5Row');
const indicator6Row = document.getElementById('indicator6Row');
const indicator7Row = document.getElementById('indicator7Row');
const indicator8Row = document.getElementById('indicator8Row');
 

async function checkRow(idrow , comparisonValue) {
    var row = document.getElementById(idrow);

    let selectedData;
    if (comparisonValue == 3){
        selectedData = row.cells[1];
    } else if (comparisonValue == 4){
        selectedData = row.cells[2];
    } else if (comparisonValue == 5){
        selectedData = row.cells[3];
    } else if (comparisonValue == 6){
        selectedData = row.cells[4];
    } else if (comparisonValue == 7){
        selectedData = row.cells[5];
    } else if (comparisonValue == 8){
        selectedData = row.cells[6];
    } else {
        selectedData = row.cells[6];
    }
    
    // Add class name correctly
    selectedData.classList.add("checked");
    
    // Access specific cells
    // var firstCell = row.cells[0]; // First cell
    // var secondCell = row.cells[1]; // Second cell

    // // Manipulate cell data
    // // Logs the content of the first cell
    // secondCell.innerHTML = "Updated content for second cell"; // Updates the content of the second cell

    // Log the updated row content
    // 
    
}



let cot = undefined;
let teacher = undefined;
let cot_content = undefined;

async function getCot() {
    try {
        
        const teacher_id = sessionStorage.getItem('teacher_id');
        const quarter = sessionStorage.getItem('quarter');
        const cot_id = sessionStorage.getItem('cot_id');

        const formData = new FormData();
        formData.append('teacher_id', teacher_id);
        formData.append('quarter', quarter);
        formData.append('cot_id', cot_id);

        const response = await fetch('https://bnahs.pythonanywhere.com/api/school/forms/cot/get/', {
            method: 'POST',
            headers: {
                'X-Requested-With': 'XMLHttpRequest',
                
            },
            credentials: 'include',
            body: formData,

        });

        const data = await response.json();
        if (response.ok) {
            
            cot = data.cot;
            teacher = data.teacher;
            cot_content = data.cot.content;
            rater = data.rater;

            
            for (var i = 0; i < 7; i++) {
                let res = i + 1;
                if (cot_content['Questions'][res]['Selected'] == 4){
                    checkRow('indicator'+(res)+'Row', 4);
                } else if (cot_content['Questions'][res]['Selected'] == 5){
                    checkRow('indicator'+(res)+'Row', 5);
                } else if (cot_content['Questions'][res]['Selected'] == 6){
                    checkRow('indicator'+(res)+'Row', 6);
                } else if (cot_content['Questions'][res]['Selected'] == 7){
                    checkRow('indicator'+(res)+'Row', 7);
                } else if (cot_content['Questions'][res]['Selected'] == 8){
                    checkRow('indicator'+(res)+'Row', 8);
                } else {
                    checkRow('indicator'+(res)+'Row', 0);
                }
            }

            // Info Section Elements
            observerName2.textContent = rater ? rater.fullname : 'Not Rated Yet';
            observationDate2.textContent = cot.check_date ? new Date(cot.check_date).toLocaleDateString() : "Not Rated Yet";
            teacherObserved2.textContent = teacher.fullname;
            observationQuarter2.textContent = cot_content['Quarter'];
            subjectGradeLevel2.textContent = cot.subject;
            schoolYear2.textContent = cot.school_year;
            additionalComments.value = cot_content["Comments"];
            teacherSignature2.value = teacher?.fullname ? teacher.fullname : "Not Rated Yet";
            observerSignature2.value = rater?.fullname ? rater?.fullname : "Not Rated Yet";


            
        } else {
            window.location.href = '../../get-started.html'; 
            
        }
    } catch (error) {
        console.error("Error during fetch:", error);
    }
}

getCot();


// Modal logic
const logoutButton = document.getElementById('logoutLink');  // Logout button
const logoutModal = document.getElementById('logoutModal');
const yesButton = document.querySelector('.yes-btn');
const noButton = document.querySelector('.no-btn');

// Show modal when logout is clicked
logoutButton.addEventListener('click', function(event) {
    event.preventDefault();  // Prevent default logout behavior
    logoutModal.classList.remove('hidden');  // Show modal by removing 'hidden' class
});

// Hide modal when "No" is clicked
noButton.addEventListener('click', function() {
    logoutModal.classList.add('hidden');  // Hide modal by adding 'hidden' class
});

// Redirect when "Yes" is clicked
yesButton.addEventListener('click', async function() {
try {

const response = await fetch('https://bnahs.pythonanywhere.com/api/user/logout/', {
    method: 'POST',
    headers: {
        'X-Requested-With': 'XMLHttpRequest',
        
    },
    credentials: 'include',
});

const data = await response.json();
if (response.ok) {
    
    window.location.href = '../../get-started.html'; 
} else {
    
}
} catch (error) {
console.error("Error during fetch:", error);
}
});
        
    </script>
</body>
</html>  