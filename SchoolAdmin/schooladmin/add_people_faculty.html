<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add People</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="add_people_faculty_css.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css" />
    <script>
        function handleCancel() {
            // Go back to the previous page
            window.history.back();
        }

        document.addEventListener('DOMContentLoaded', function () {
            // Select all required inputs, select elements, and date inputs, as well as specific elements by ID
            const requiredElements = document.querySelectorAll(
                'input[required]:not(#middle-name), select[required], input[type="date"][required], #job-started, #position, #grade-level, #role, #department'
            );

            requiredElements.forEach(element => {
                const label = element.previousElementSibling;
                if (label) {
                    // Create the icon
                    const icon = document.createElement('img');
                    // Use a relative path assuming assets are in a folder next to this HTML file
                    icon.src = './assets/Circle_Warning.png';
                    icon.alt = 'Required field';
                    icon.classList.add('required-icon'); // Add class for styling

                    // Append the icon after the label text
                    label.appendChild(icon);
                }
            });
        });
    </script>

    <style>
        /* Style for the required field icon */
        .required-icon {
            width: 12px; /* Smaller size for the icon */
            height: 12px;
            margin-left: 5px; /* Space between label and icon */
            vertical-align: middle; /* Align icon with text */
        }
    </style>
</head>
    <body>
        <nav class="navbar">
            <div class="navbar-logo">
                <img src="assets\image 6.png" alt="DepED Logo" />
            </div>
            <ul class="navbar-menu">
                <li><a href="schooladmin_home.html" class="nav-link"><img src="assets/House_01.png" alt="Home Icon" class="nav-icon"> Home</a></li>
                <li><a href="faculty.html" class="nav-link faculty active "><img src="assets/Users_Group.png" alt="Faculty Icon" class="nav-icon"> Faculty</a></li>
                <li><a href="request.html" class="nav-link request active"><i class="fas fa-clipboard-list"></i>Request</a></li>
                <li><a href="sadmin_form.html" class="nav-link form"><img src="assets/File_Document1.png" alt="Faculty Icon" class="nav-icon"> Form</a></li>
                <li><a href="results.html" class="nav-link"><img src="assets/Check Document.png" alt="Results Icon" class="nav-icon"> Results</a></li>
                <li><a href="records.html" class="nav-link"><img src="assets/Folders1.png" alt="Records Icon" class="nav-icon"> Records</a></li>
                <li id="logoutLink" class="logout-btn">
                    <a href="../../index.html">
                        <img src="assets/Log_Out.png" alt="Logout Icon" class="nav-icon"> Logout
                    </a>
                </li>
            </ul>
        </nav>

    <div class="container">
        <h1>Add people</h1>
        <form action="" class="add-people-form">
            <div class="form-row">
                <label for="employee-id">Employee ID</label>
                <input type="text" id="employee-id" name="employee_id" required>
                <span class="error-message-id" id="employee-id-error"></span>
            </div>
            
            <div class="form-row name-fields">
                <div>
                    <label for="first-name">First Name</label>
                    <input type="text" id="first-name" name="first_name" required>
                    <span class="error-message1" id="first-name-error"></span>
                </div>
                <div>
                    <label for="middle-name">Middle Name</label>
                    <input type="text" id="middle-name" name="middle_name">
                    <span class="error-message1" id="first-name-error"></span>
                </div>
                <div>
                    <label for="last-name">Last Name</label>
                    <input type="text" id="last-name" name="last_name" required>
                    <span class="error-message1" id="last-name-error"></span>
                </div>
            </div>
        
            <div class="form-row">
                <label for="email">Email Address</label>
                <input type="email" id="email" name="email" required>
                <span class="error-message" id="email-error"></span>
            </div>
        
            <div class="form-row">
                <label for="job-started">Job Started</label>
                <input type="date" id="job-started" name="job_started">
                <span class="error-message-js" id="job-started-error"></span>
            </div>
        
            <div class="form-row">
                <label for="position">Position</label>
                <select id="position" name="position">
                    <option value="" disabled selected>Select Position</option>
                    <option value="Teacher I">Teacher I</option>
                    <option value="Teacher II">Teacher II</option>
                    <option value="Teacher III">Teacher III</option>
                    <option value="Master Teacher I">Master Teacher I</option>
                    <option value="Master Teacher II">Master Teacher II</option>
                    <option value="Master Teacher III">Master Teacher III</option>
                    <option value="Master Teacher IV">Master Teacher IV</option>
                    <option value="Head Teacher I">Head Teacher I</option>
                    <option value="Head Teacher II">Head Teacher II</option>
                    <option value="Head Teacher III">Head Teacher III</option>
                    <option value="Head Teacher IV">Head Teacher IV</option>
                    <option value="Head Teacher V">Head Teacher V</option>
                    <option value="Head Teacher VI">Head Teacher VI</option>
                    <!-- <option value="Assistant School Principal I">Assistant School Principal I</option>
                    <option value="Assistant School Principal II">Assistant School Principal II</option>
                    <option value="Assistant School Principal III">Assistant School Principal III</option> -->
                    <option value="School Principal I">School Principal I</option>
                    <option value="School Principal II">School Principal II</option>
                    <option value="School Principal III">School Principal III</option>
                    <option value="School Principal IV">School Principal IV</option>
                    <!-- more options... -->
                </select>
                <span class="error-message-pos" id="position-error"></span>
            </div>
        
            <div class="form-row">
                <label for="grade-level">Grade Level</label>
                <select id="grade-level" name="grade-level">
                    <option value="" disabled selected>Select Grade Level</option>
                    <option value="Grade 1">Grade 1</option>
                    <option value="Grade 2">Grade 2</option>
                    <option value="Grade 3">Grade 3</option>
                    <option value="Grade 4">Grade 4</option>
                    <option value="Grade 5">Grade 5</option>
                    <option value="Grade 6">Grade 6</option>
                    <option value="Grade 7">Grade 7</option>
                    <option value="Grade 8">Grade 8</option>
                    <option value="Grade 9">Grade 9</option>
                    <option value="Grade 10">Grade 10</option>
                    <option value="Grade 11">Grade 11</option>
                    <option value="Grade 12">Grade 12</option>
                    <!-- Add more options as needed -->
                    <!-- more options... -->
                </select>
                <span class="error-message-gl" id="grade-level-error"></span>
            </div>
        
        
            <div class="form-row">
                <label for="department">Department</label>
                <select id="department" name="department">
                    <option value="" disabled selected>Select Department</option>
                    <option value="MTB-MLE">MTB-MLE</option>
                        <option value="Madrash Alive">Madrasah ALIVE</option>
                        <option value="Filipino">Filipino</option>
                        <option value="English">English</option>
                        <option value="Mathematics">Mathematics</option>
                        <option value="Science">Science</option>
                        <option value="Araling Panlipunan">Araling Panlipunan</option>
                        <option value="Edukasyon sa Pagpapakatao">Edukasyon sa Pagpapakatao</option>
                        <option value="MAPEH">MAPEH</option>
                        <option value="Music">Music</option>
                        <option value="Arts">Arts</option>
                        <option value="Physical Education">Physical Education</option>
                        <option value="Health">Health</option>
                        <option value="TLE/EPP-HE">TLE/EPP-HE</option>
                        <option value="TLE/EPP-LE/Tech-Voc">TLE/EPP-LE/Tech-Voc</option>
                        <option value="ALS">ALS</option>
                        <option value="IPED">IPED</option>
                        <option value="Special Programs">Special Programs</option>
                </select>
                <span class="error-message-dept" id="department-error"></span>
            </div>
        
            <div class="form-row">
                <label for="password">Password</label>
                <div class="password-container">
                    <input type="password" id="password" name="password" required>
                    <i class="bi bi-eye-slash" id="togglePassword"></i>
                </div>
                <span class="error-message-pass" id="password-error"></span>
            </div>            
        
            <div class="form-row">
                <label for="confirm-password">Confirm Password</label>
                <input type="password" id="confirm-password" name="confirm_password" required>
                <span class="error-message-match" id="confirm-password-error"></span>
            </div>
        
            <div class="form-actions">
                <button type="button" class="cancel-btn" onclick="handleCancel()">Cancel</button>
                <button type="submit" class="register-btn">Register</button>
            </div>
        </form>
    </div>
    <!-- Logout Confirmation Modal -->
    <div id="logoutModal" class="modal hidden">
        <div class="modal-content">
            <p>Are you sure you want to logout?</p>
            <div class="modal-buttons">
                <button class="yes-btn">Yes</button>
                <button class="no-btn">No</button>
            </div>
        </div>
    </div>
    
    <script>// Modal logic
        const logoutButton = document.getElementById('logoutLink');  // Logout button
        const logoutModal = document.getElementById('logoutModal');
        const yesButton = document.querySelector('.yes-btn');
        const noButton = document.querySelector('.no-btn');
        
        // Show modal when logout is clicked
        logoutButton.addEventListener('click', function(event) {
            event.preventDefault();  // Prevent default logout behavior
            logoutModal.classList.remove('hidden');  // Show modal by removing 'hidden' class
        });
        
        // Hide modal when "No" is clicked
        noButton.addEventListener('click', function() {
            logoutModal.classList.add('hidden');  // Hide modal by adding 'hidden' class
        });
        
        // Redirect when "Yes" is clicked
        yesButton.addEventListener('click', async function() {
    try {
        
        const response = await fetch('https://bnahs.pythonanywhere.com/api/user/logout/', {
            method: 'POST',
            headers: {
                'X-Requested-With': 'XMLHttpRequest',
                
            },
            credentials: 'include',
        });

        const data = await response.json();
        if (response.ok) {
            console.log("Success Data : ", data); 
            window.location.href = '../../get-started.html'; 
        } else {
            console.log("Error Data : ", data);
        }
    } catch (error) {
        console.error("Error during fetch:", error);
    }
});

const togglePassword = document.querySelector("#togglePassword");
        const password = document.querySelector("#password");

        togglePassword.addEventListener("click", function () {
            // toggle the type attribute
            const type = password.getAttribute("type") === "password" ? "text" : "password";
            password.setAttribute("type", type);
            
            // toggle the icon
            this.classList.toggle("bi-eye");
        });


        function showError(id, message) {
    const errorElement = document.getElementById(id);
    errorElement.innerText = message;
    errorElement.style.display = "block";
}

function clearError(id) {
    const errorElement = document.getElementById(id);
    errorElement.innerText = "";
    errorElement.style.display = "none";
}

function validateForm() {
    let isValid = true;

    // Validate Employee ID
    const employeeId = document.getElementById("employee-id");
    if (employeeId.value.trim() === "") {
        showError("employee-id-error", "Employee ID is required.");
        isValid = false;
    } else {
        clearError("employee-id-error");
    }

    // Validate First Name
    const firstName = document.getElementById("first-name");
    if (firstName.value.trim() === "") {
        showError("first-name-error", "First name is required.");
        isValid = false;
    } else {
        clearError("first-name-error");
    }

    // Validate Last Name
    const lastName = document.getElementById("last-name");
    if (lastName.value.trim() === "") {
        showError("last-name-error", "Last name is required.");
        isValid = false;
    } else {
        clearError("last-name-error");
    }

    // Validate Email
    const email = document.getElementById("email");
    const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (email.value.trim() === "") {
        showError("email-error", "Email is required.");
        isValid = false;
    } else if (!emailPattern.test(email.value)) {
        showError("email-error", "Invalid email format.");
        isValid = false;
    } else {
        clearError("email-error");
    }

    // Validate Job Started
    const jobStarted = document.getElementById("job-started");
    if (jobStarted.value === "") {
        showError("job-started-error", "Job start date is required.");
        isValid = false;
    } else {
        clearError("job-started-error");
    }

    // Validate Position
    const position = document.getElementById("position");
    if (position.value === "") {
        showError("position-error", "Position is required.");
        isValid = false;
    } else {
        clearError("position-error");
    }

    // Validate Grade Level
    const gradeLevel = document.getElementById("grade-level");
    if (gradeLevel.value === "") {
        showError("grade-level-error", "Grade level is required.");
        isValid = false;
    } else {
        clearError("grade-level-error");
    }

    // Validate Department
    const department = document.getElementById("department");
    if (department.value === "") {
        showError("department-error", "Department is required.");
        isValid = false;
    } else {
        clearError("department-error");
    }

    // Validate Password with 12+ characters, uppercase, lowercase, number, and special character
    const password = document.getElementById("password");
    const passwordPattern = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[\W_]).{12,}$/;
    if (!passwordPattern.test(password.value)) {
        showError("password-error", "Password must be at least 12 characters and contain a special character.");
        isValid = false;
    } else {
        clearError("password-error");
    }

    // Validate Confirm Password
    const confirmPassword = document.getElementById("confirm-password");
    if (confirmPassword.value !== password.value) {
        showError("confirm-password-error", "Passwords do not match.");
        isValid = false;
    } else {
        clearError("confirm-password-error");
    }

    // If all fields are valid, submit the form
    if (isValid) {
        registerPeople();
        //document.getElementById("add-people-form").submit();
    }
}
</script>
    <script src="add-people.js" type="module"></script>
</body>
</html>
